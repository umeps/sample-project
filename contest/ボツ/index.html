<!DOCTYPE html>
<html>
<head>
    <title>近未来店舗</title>
  <meta charset="utf-8"/>
  <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Nova+Round">
  <link rel="stylesheet" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</head>
<body>

        <div id="container"></div>

  <script type="module">
	  	import * as THREE from 'https://threejs.org/build/three.module.js';
		import { TWEEN } from 'https://threejs.org/examples/jsm/libs/tween.module.min.js';
		import { TrackballControls } from 'https://threejs.org/examples/jsm/controls/TrackballControls.js';
		import { CSS3DRenderer, CSS3DObject } from 'https://threejs.org/examples/jsm/renderers/CSS3DRenderer.js';

		

		var table = [

            "img/6.png","#","Column",1,1,
			"img/1.png","#","Column",1,2,
			"img/5.png","#","Column",1,3,
			"img/4.png","#","Column",1,4,
			"img/1.png","#","Column",1,5,
			"img/1.png","#","Column",1,6,
			"img/5.png","#","Column",1,7,
			"img/1.png","#","Column",1,8,
			"img/4.png","#","Column",1,9,
			"img/1.png","#","Design",2,1,
			"img/1.png","#","Design",2,2,
			"img/6.png","#","Design",2,3,
			"img/5.png","#","Design",2,4,
			"img/2.png","#","Design",2,5,
			"img/2.png","#","Design",2,6,
			"img/4.png","#","Design",2,7,
			"img/2.png","#","Design",2,8,
			"img/6.png","#","Design",2,9,
			"img/2.png","#","Design",3,1,
			"img/5.png","#","Know-how",3,2,
			"img/2.png","#","Know-how",3,3,
			"img/2.png","#","Know-how",3,4,
			"img/4.png","#","Know-how",3,5,
			"img/2.png","#","Know-how",3,6,
			"img/3.png","#","Know-how",3,7,
			"img/3.png","#","Know-how",3,8,
			"img/6.png","#","Know-how",3,9,
			"img/3.png","#","Technology",4,1,
			"img/3.png","#","Technology",4,2,
			"img/3.png","#","Technology",4,3,
			"img/6.png","#","Technology",4,4,
			"img/3.png","#","Technology",4,5,
			"img/3.png","#","Technology",4,6,
			"img/3.png","#","Technology",4,7,
			"img/6.png","#","Technology",4,8,
			"img/3.png","#","Technology",4,9,


		];

		var camera, scene, renderer;
		var controls;
		var objects = [];
		var targets = { table: [], sphere: [], helix: [], grid: [] };
		init();
		animate();
		function init() {
			camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 5000 );
			camera.position.z = 3000;
			scene = new THREE.Scene();

			for ( var i = 0; i < table.length; i += 5 ) {

				var element = document.createElement( 'a' );
				element.className = 'element ' + table[ i + 2];
				element.setAttribute("href",table[ i + 1 ])
				// element.style.backgroundColor = 'rgba(0,127,127,' + ( Math.random() * 0.5 + 0.25 ) + ')';

				var symbol = document.createElement( 'img' );
				symbol.src = table[ i ];
				element.appendChild( symbol );

				var object = new CSS3DObject(element);
				object.position.x = Math.random() * 4000 - 2000;
				object.position.y = Math.random() * 4000 - 2000;
				object.position.z = Math.random() * 4000 - 2000;
				scene.add(object);

                objects.push(object);
				var object = new THREE.Object3D();
				object.position.x = (table[i + 3] * 140) - 1330;
				object.position.y = - (table[i + 4] * 180) + 990;
				targets.table.push(object);

			}

			var vector = new THREE.Vector3();
			for ( var i = 0, l = objects.length; i < l; i ++ ) {
				var phi = Math.acos( -1 + ( 2 * i ) / l );
				var theta = Math.sqrt( l * Math.PI ) * phi;
				var object = new THREE.Object3D();
				object.position.setFromSphericalCoords(1600, phi, theta);
				vector.copy( object.position ).multiplyScalar( 2 );
				object.lookAt( vector );
				targets.sphere.push( object );
			}

			renderer = new CSS3DRenderer();
			renderer.setSize(window.innerWidth, window.innerHeight);
			document.getElementById('container').appendChild(renderer.domElement);

			controls = new TrackballControls(camera, renderer.domElement);
			controls.minDistance = 500;
            controls.maxDistance = 6000;
            controls.rotateSpeed = 3;
            controls.addEventListener('change', render);

			transform( targets.sphere, 2000 );
			window.addEventListener( 'resize', onWindowResize, false );
		}

		function transform( targets, duration ) {
			TWEEN.removeAll();

			for ( var i = 0; i < objects.length; i ++ ) {

				var object = objects[ i ];
				var target = targets[ i ];

				new TWEEN.Tween( object.position )
					.to( { x: target.position.x, y: target.position.y, z: target.position.z }, Math.random() * duration + duration )
					.easing( TWEEN.Easing.Exponential.InOut )
					.start();

				new TWEEN.Tween( object.rotation )
					.to( { x: target.rotation.x, y: target.rotation.y, z: target.rotation.z }, Math.random() * duration + duration )
					.easing( TWEEN.Easing.Exponential.InOut )
					.start();

			}

			new TWEEN.Tween( this )
				.to( {}, duration * 2 )
				.onUpdate( render )
				.start();


		}


		function onWindowResize() {

			camera.aspect = window.innerWidth / window.innerHeight;
			camera.updateProjectionMatrix();
			renderer.setSize( window.innerWidth, window.innerHeight );

		}

		function animate() {

			requestAnimationFrame( animate );
			TWEEN.update();
			controls.update();

		}

		function render() {

			renderer.render( scene, camera );

		}

		function tick(){
			object.rotation.x += 0.02;
		}
	</script>
</body>
</html>